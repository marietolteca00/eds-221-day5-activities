---
title: "us_tilapia_imports"
output: html_document
---

```{r}
library(tidyverse)
library(here)
library(janitor)
```
#Read in the data as us_tilapia_imports
```{r}
us_tilapia_imports <- read_csv(here::here("data","us_tilapia_imports.csv"))
```
#Explore the data. What are the classes of the columns? Remember some tools we’ve used: summary, names, dim, skim, etc.

```{r}
skimr::skim(us_tilapia_imports)
names(us_tilapia_imports)
dim(us_tilapia_imports)
summary(us_tilapia_imports)
```
#Use pivot_longer() to reshape the data into long format (currently, the variable “year” is spread across multiple columns). Remember to store the output so you will be able to use the reshaped data this creates.

```{r}
# Using pivot_longer- allows for data to be shown with only longer columns
pivot_df <- us_tilapia_imports %>% # Data then pipe
  # using pivot_longer, call out the columns by country, names to year, and values as taliapia imports
  pivot_longer(cols=-country, names_to = "year", values_to = "tilapia_imports" )
```

# Check the class of the year column. What is it, and why do you think that’s the case? Then, coerce the year column to numeric (e.g. using mutate() and as.numeric() in combination)
```{r}
# now with the pivot longer data, change the year column to be numberic
mutate_pivot <- pivot_df %>% 
  mutate(year=as.numeric(year))
#check class(mutate_pivot$year) = numeric
```

# Use dplyr::group_by() %>% summarize() to find the total US tilapia imports by year, store as yearly_tilapia_tot
```{r}
yearly_tilapia <- mutate_pivot %>% 
  #group the column year, AND THEN
  group_by(year) %>% 
  # summarize by ANNUAL TOTALS, get the SUM of tilapia imports and remove NA values by na.rm=TRUE
  summarize(annual_total= sum(tilapia_imports, na.rm = TRUE))
```


# Create a ggplot line graph of total US tilapia imports for all years in yearly_tilapia_tot. Update axis labels (include units as necessary), then export your graph as a .png to figs.
```{r}
# for arrow 
myarrow = arrow(angle = 15, ends = "both", type = "closed")
Yearly_tilapia_imports <- ggplot(yearly_tilapia, aes(x=year, y=annual_total))+
  geom_line(linetype= "dashed", color= "blue", arrow=myarrow)+
  geom_point(color="red", size=2)+
     labs(y= "Annual Total Imports",
              x= "Years",
          title = "United States Tilapia Fish Imports",
          subtitle = "Showing Tilapia Fish Imports over time") +
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(plot.subtitle = element_text(hjust = 0.5))

Yearly_tilapia_imports

# Saving plot into figs folder
ggsave(here::here("figs", "Yearly_tilapia_imports.png"), # setting filepath to save line plot
       width = 6, height = 5)

```

Create a subset that only retains imports from Ecuador, Honduras, Costa Rica, and Mexico (you decide what to name this)

```{r}
subset_country_imports <- 
  # Subsetting by colum using %in% c(). using c() allows to call out values in a vector
  subset(mutate_pivot, country %in% c("Ecuador","Honduras", "Costa Rica", "Mexico"))
```

Create a ggplot graph of total US tilapia imports over time, for those four countries in the subset you created above, separated by country. Update axis labels, add a title, customize your color scheme, update the theme. Export a .jpg of your graph to figs
```{r}
Country_Imports <- ggplot(subset_country_imports, aes(x=year, y= tilapia_imports))+
  geom_point(aes(color= country))+
  scale_color_brewer(palette = "Set2")+
  labs(x= "Years",
       y= "Tilapia Imports",
       title = "Tilapia Imports by Country",
       subtitle= "Tilapia imports by country over years",
       color= "Country")+
    theme_grey()+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(plot.subtitle = element_text(hjust = 0.5))

Country_Imports

# Saving plot
ggsave(here::here("figs", "Country_Imports.png"), # setting filepath to save line plot
       width = 6, height = 5)
```

